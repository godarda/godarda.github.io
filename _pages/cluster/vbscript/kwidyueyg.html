---
permalink: cluster/vbscript/kwidyueyg
title: VBScript to read the data from an Excel sheet using ADODB object
---

<div class="codecard">Example 1: {{ page.title }} (Active Data Objects Data Base)</div>
<div class="card">{{ site.vbsfile }}</div>
<pre>{%- highlight vb -%}
Option Explicit
Dim objCon, objRecordSet

Set objCon = CreateObject("ADODB.Connection")
Set objRecordSet = CreateObject("ADODB.Recordset")

objCon.Open "DRIVER={Microsoft Excel Driver (*.xls)};DBQ=D:\VBScript\Trial.xls;Readonly=True"
objRecordSet.Open "SELECT * FROM [Sheet1$]",objCon
Msgbox objRecordSet.GetString
Set objRecordSet = Nothing
Set objCon = Nothing
{%- endhighlight -%}</pre>
<div class="card">{{ site.output }}</div>
<span><pre>
<img src="_pages/cluster/vbscript/images/kwidyvziz.png" loading="lazy">
</pre></span>

<div class="codecard">Example 2: {{ page.title }}</div>
<div class="card">{{ site.vbsfile }}</div>
<pre>{%- highlight vb -%}
Dim objCon, objRecordSet, strExlFile
Set objCon = CreateObject("ADODB.Connection")
Set objRecordSet = CreateObject("ADODB.Recordset")
strExlFile = "D:\VBScript\Trial.xls"
objCon.Open "DRIVER={Microsoft Excel Driver (*.xls)};DBQ="&strExlFile&";Readonly=True"

Set result = objCon.Execute("Select * from [Sheet1$]")
colCount = result.Fields.Count
MsgBox "Number of column: " & colCount & vbcrlf & result.GetString 

Set objRecordSet = Nothing
objCon.Close
Set objCon = Nothing
{%- endhighlight -%}</pre>
<div class="card">{{ site.output }}</div>
<span><pre>
<img src="_pages/cluster/vbscript/images/kwidrcamg.png" loading="lazy">
</pre></span>